<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Map.ABT.Dongtangnaw</title>

  <!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå + PWA -->
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2196f3">

  <style>
    html, body { height:100%; margin:0; font-family:'Kanit', sans-serif; overflow:hidden; }

    body{
      background: url('Background.png') no-repeat center center fixed;
      background-size: cover;
      display:flex; flex-direction:column;
    }

    header{
      display:flex; align-items:center; justify-content:center; gap:12px;
      background: rgba(0,100,0,.75); color:#fff; padding:8px;
      font-size:20px; font-weight:600; text-align:center;
      backdrop-filter: blur(3px); border-radius:8px; margin:8px;
    }
    header img{ height:50px; }

    .controls{
      display:flex; gap:8px; align-items:center; justify-content:center;
      padding:10px; margin:0 8px 8px;
      background: rgba(255,255,255,.85); backdrop-filter: blur(3px);
      box-shadow:0 1px 6px rgba(0,0,0,.12); border-radius:10px;
    }
    select{ font:inherit; padding:6px 10px; border-radius:6px; border:1px solid #ccc; min-width:240px; }

    #map-area{ flex:1; margin:8px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.25);
               background:rgba(255,255,255,.6); overflow:hidden; }

    .map-wrap{ position:relative; width:100%; height:100%; }
    #mapFrame{ width:100%; height:100%; border:0; }

    /* overlay ‡∏à‡∏≤‡∏á ‡πÜ ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏£‡πå + fullscreen */
    .overlay-top-right{
      position:absolute;
      top:8px;
      right:8px;
      width:120px; height:44px;
      background: rgba(0,0,0,0.1);
      border-radius:6px;
      z-index:5;
      pointer-events:auto;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢ (FAB) */
    .fab{
      position:fixed; right:16px; z-index:10000;
      width:56px; height:56px; border:none; border-radius:50%;
      display:grid; place-items:center; color:#fff; cursor:pointer;
      box-shadow:0 8px 18px rgba(0,0,0,.28); font-size:22px;
      transition: transform .25s, box-shadow .25s;
      overflow:hidden;
    }
    .fab:hover{ transform: scale(1.1); box-shadow:0 10px 20px rgba(0,0,0,.35); }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á */
    #installBtn{ bottom:88px; background: linear-gradient(135deg,#0284c7,#0ea5e9); }
    #installBtn svg{ width:28px; height:28px; pointer-events:none; }
    #installBtn::after{
      content:""; position:absolute; inset:0; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%);
      transform: scale(0); opacity:0; transition: transform .35s, opacity .35s;
    }
    #installBtn:active::after{ transform: scale(1); opacity:1; }
    #installBtn.pop{ animation: btnPop .35s ease; }
    @keyframes btnPop{
      0%{ transform: scale(1); }
      50%{ transform: scale(1.12); }
      100%{ transform: scale(1); }
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä */
    #refreshBtn{ bottom:20px; background: linear-gradient(135deg,#16a34a,#22c55e); }
    #refreshBtn svg{ width:26px; height:26px; pointer-events:none; }
    #refreshBtn::after{
      content:""; position:absolute; inset:0; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,255,255,.3) 0%, rgba(255,255,255,0) 60%);
      transform: scale(0); opacity:0; transition: transform .35s, opacity .35s;
    }
    #refreshBtn:active::after{ transform: scale(1); opacity:1; }
    #refreshBtn.spin svg{ animation: spin 1s linear; }
    @keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï */
    #updateBtn{
      display:none;
      position:fixed; bottom:160px; right:16px;
      background:#ff9800; color:#fff;
      border:none; border-radius:8px;
      padding:10px 14px; font-size:16px;
      box-shadow:0 4px 10px rgba(0,0,0,0.25);
      z-index:10000; cursor:pointer;
    }

    /* Splash */
    #splash{
      position: fixed; inset: 0;
      display: grid; place-items: center;
      background: #d0f8ce; /*<‡∏™‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î>*/
      backdrop-filter: blur(3px);
      z-index: 10050;
      opacity: 1; 
      transition: opacity .25s ease; 
	  
    }
    #splash.hide{ opacity: 0; pointer-events: none; }
    #splash .splash-logo{
      width: 250px; height: 250px; object-fit: contain; margin-bottom: 12px;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,.2));
      animation: pop .45s ease both;
    }
    #splash .splash-text{
      margin: 0; 
	  font-weight: 600; 
	  font-size: 25px; 
	  color: #0d5302;
      text-shadow: 
	  -2px -2px 0 #fff;
       2px -2px 0 #fff;
	  -2px  2px 0 #fff;
	   2px  2px 0 #fff;
	  -2px	0	0 #fff;
	   2px	0	0 #fff;
	   0   -2px 0 #fff;
	   0	2px 0 #fff;
	   
    }	
    @keyframes pop{
      from{ transform: scale(.9); opacity:.6 }
      to  { transform: scale(1);  opacity:1 }
    }
	
#versionTag {     
	position: fixed;
	top: 8px;
	right: 12px;
	color: white;
	font-size: 15px;
	font-weight: bold;
	text-shadow: 2px 2px 4px rgba (0,0,0,0.8);
	z-index: 11000;
	font-family: 'Kanit',sans-serif;
	}
	
  </style>
</head>
<body>
  <header>
    <img src="welcome.png" alt="Welcome">
    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏π‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (Select a Map)
    <img src="logo.png" alt="Logo">
  </header>
	<div id="versionTag">v1.1.4</div> 
  <div class="controls">
    <label for="mapSelect">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà:</label>
    <select id="mapSelect">
      <option value="https://www.google.com/maps/d/embed?mid=1rCujO4jFJ2h2wSa_pnlcmrOaQPZNrhM&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏ö‡∏•‡∏î‡∏á‡∏ï‡∏∞‡∏á‡∏≤‡∏ß (Map of Dong Ta Ngao Subdistrict) </option>
      <option value="https://www.google.com/maps/d/embed?mid=1zy3WJ1VOzjpWf1gJQ36VGh1TaB9_7L4&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÇ‡∏ã‡∏•‡πà‡∏≤‡πÄ‡∏ã‡∏•‡∏•‡πå (Solar Power Pole Plan) </option>
      <option value="https://www.google.com/maps/d/embed?mid=1DS8CSBurVMUU-px6qC-HrWu8Wa5CCj0&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏ô‡πâ‡∏≥‡∏ó‡πà‡∏ß‡∏° (Flood Crisis Map)</option>
    </select>
	
	<a href="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Map ABT.pdf" target="_blank"
   style="margin-left:10px; padding:6px 12px; Background:#2196f3; color:#fff;
   text-decoration:none; border-radius:10px; font-weight:50;">
	üìñ ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠
	</a>
</div>

<div id="map-area">
    <div class="map-wrap">
      <iframe id="mapFrame"
        src="https://www.google.com/maps/d/embed?mid=1rCujO4jFJ2h2wSa_pnlcmrOaQPZNrhM&hl=th&ehbc=2E312F"
        allowfullscreen></iframe>
      <div class="overlay-top-right" title="‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á My Maps"></div>
    </div>
  </div>

  <!-- FAB ‡∏õ‡∏∏‡πà‡∏° -->
  <button id="installBtn" class="fab" title="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ">
    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
      <polyline points="7 10 12 15 17 10"/>
      <line x1="12" y1="3" x2="12" y2="15"/>
    </svg>
  </button>

  <button id="refreshBtn" class="fab" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä">
    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="23 4 23 10 17 10"/>
      <polyline points="1 20 1 14 7 14"/>
      <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
    </svg>
  </button>

  <button id="updateBtn">üîÑ ‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà ‚Äì ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</button>

  <!-- Splash -->
  <div id="splash" aria-live="polite">
    <img src="logo.png" alt="" class="splash-logo">
    <p class="splash-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶</p>
  </div>

  <script>
    const sel = document.getElementById('mapSelect');
    const frame = document.getElementById('mapFrame');
    const saved = localStorage.getItem('abt_selected_map_value');
    if (saved) { sel.value = saved; frame.src = saved; }
    sel.addEventListener('change', () => {
      showSplash('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶');
      frame.src = sel.value;
      localStorage.setItem('abt_selected_map_value', sel.value);
      const t = setTimeout(hideSplash, 2000);
      const onLoaded = () => { clearTimeout(t); hideSplash(); frame.removeEventListener('load', onLoaded); };
      frame.addEventListener('load', onLoaded);
    });

    document.getElementById('refreshBtn').addEventListener('click', () => {
      const btn = document.getElementById('refreshBtn');
      btn.classList.add('spin');
      setTimeout(()=>btn.classList.remove('spin'),1000);
      showSplash('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‚Ä¶');
      frame.src = frame.src;
      const t = setTimeout(hideSplash, 1500);
      const onLoaded = () => { clearTimeout(t); hideSplash(); frame.removeEventListener('load', onLoaded); };
      frame.addEventListener('load', onLoaded);
    });

    /* PWA Install */
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');
    function isStandalone(){
      return (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches)
             || window.navigator.standalone;
    }
    function updateInstallBtn(){
      installBtn.hidden = isStandalone() || localStorage.getItem('abt_installed')==='1';
    }
    updateInstallBtn();

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      updateInstallBtn();
    });
    installBtn.addEventListener('click', async () => {
      installBtn.classList.add('pop');
      setTimeout(()=>installBtn.classList.remove('pop'), 350);
      if (!deferredPrompt) return;
      installBtn.hidden = true;
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    });
    window.addEventListener('appinstalled', () => {
      localStorage.setItem('abt_installed','1');
      updateInstallBtn();
    });

    /* SW Update */
    const updateBtn = document.getElementById('updateBtn');
    let newWorker;
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const reg = await navigator.serviceWorker.register('./sw.js');
          reg.update();
          setInterval(() => reg.update(), 15*60*1000);
          reg.addEventListener('updatefound', () => {
            newWorker = reg.installing;
            newWorker?.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                updateBtn.style.display = 'block';
              }
            });
          });
          navigator.serviceWorker.addEventListener('controllerchange', () => location.reload());
        } catch (e) { console.warn('SW register failed', e); }
      });
    }
    updateBtn.addEventListener('click', () => {
      if (newWorker) newWorker.postMessage({ action: 'SKIP_WAITING' });
    });

    /* Splash helpers */
    const splash = document.getElementById('splash');
    function showSplash(msg = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶') {
      const textEl = splash.querySelector('.splash-text');
      if (textEl) textEl.textContent = msg;
      splash.classList.remove('hide');
    }
    function hideSplash() { setTimeout(() => splash.classList.add('hide'), 100); }
    showSplash();
    const firstTimeout = setTimeout(hideSplash, 2000);
    frame.addEventListener('load', () => { clearTimeout(firstTimeout); hideSplash(); }, { once:true });
    </script>
</body>
</html>


