<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Map.ABT.Dongtangnaw</title>

  <!-- ‡∏ü‡∏≠‡∏ô‡∏ï‡πå + PWA -->
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2196f3">

  <style>
    html, body { height:100%; margin:0; font-family:'Kanit', sans-serif; overflow:hidden; }
	
    body{
      background: url('Background‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°.png') no-repeat center center fixed;
      background-size: cover;
      display:flex; flex-direction:column;
    }

    header{ 
      display:flex; align-items:center; justify-content:center; gap:12px;
      background: #2196F3; color:#fff; padding:8px;
      font-size:20px; font-weight:600; text-align:center;
      backdrop-filter: blur(3px); border-radius:8px; margin:8px;
    }
    header img{ height:50px; }

    .controls{
      display:flex; gap:8px; align-items:center; justify-content:center;
      padding:10px; margin:0px 8px 8px;
      background: rgba(255,255,255,.85); backdrop-filter: blur(3px);
      box-shadow:0 1px 6px rgba(0,0,0,.12); border-radius:10px;
    }
    select{ font:inherit; padding:6px 10px; border-radius:6px; border:1px solid #ccc; min-width:240px; }

    #map-area{ flex:1; margin:8px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,.25);
               background:rgba(255,255,255,.6); overflow:hidden; }

    .map-wrap{ position:relative; width:100%; height:100%; }
    #mapFrame{ width:100%; height:100%; border:0; }

    /* overlay ‡∏à‡∏≤‡∏á ‡πÜ ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏£‡πå + fullscreen */
    .overlay-top-right{
      position:absolute;
      top:8px;
      right:8px;
      width:120px; height:44px;
      background: rgba(0,0,0,0.1);
      border-radius:6px;
      z-index:5;
      pointer-events:auto;
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢ (FAB) */
    .fab{
      position:fixed; right:16px; z-index:10000;
      width:56px; height:56px; border:none; border-radius:50%;
      display:grid; place-items:center; color:#fff; cursor:pointer;
      box-shadow:0 8px 18px rgba(0,0,0,.28); font-size:22px;
      transition: transform .25s, box-shadow .25s;
      overflow:hidden;
    }
    .fab:hover{ transform: scale(1.1); box-shadow:0 10px 20px rgba(0,0,0,.35); }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á */
    #installBtn{ bottom:88px; background: linear-gradient(135deg,#0284c7,#0ea5e9); }
    #installBtn svg{ width:28px; height:28px; pointer-events:none; }
    #installBtn::after{
      content:""; position:absolute; inset:0; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%);
      transform: scale(0); opacity:0; transition: transform .35s, opacity .35s;
    }
    #installBtn:active::after{ transform: scale(1); opacity:1; }
    #installBtn.pop{ animation: btnPop .35s ease; }
    @keyframes btnPop{
      0%{   transform: scale(1); }
      50%{  transform: scale(1.12); }
      100%{ transform: scale(1); }
    }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä */
    #refreshBtn{ bottom:20px; background: linear-gradient(135deg,#16a34a,#22c55e); }
    #refreshBtn svg{ width:26px; height:26px; pointer-events:none; }
    #refreshBtn::after{
      content:""; position:absolute; inset:0; border-radius:50%;
      background: radial-gradient(circle at center, rgba(255,255,255,.3) 0%, rgba(255,255,255,0) 60%);
      transform: scale(0); opacity:0; transition: transform .35s, opacity .35s;
    }
    #refreshBtn:active::after{ transform: scale(1); opacity:1; }
    #refreshBtn.spin svg{ animation: spin 1s linear; }
    @keyframes spin{ from{transform:rotate(0)} to{transform:rotate(360deg)} }

    /* ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï */
    #updateBtn{
      display:none;
      position:fixed; bottom:160px; right:16px;
      background:#ff9800; color:#fff;
      border:none; border-radius:8px;
      padding:10px 14px; font-size:16px;
      box-shadow:0 4px 10px rgba(0,0,0,0.25);
      z-index:10000; cursor:pointer;
    }

    /* Splash */
    #splash{
      position: fixed; inset: 0;
      display: grid; place-items: center;
      background: #b2ebf2; /*<‡∏™‡∏µ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î>*/
      backdrop-filter: blur(3px);
      z-index: 10050;
      opacity: 1; 
      transition: opacity .25s ease; 
	  
    }
    
	#splash.hide{ opacity: 0; pointer-events: none; }
    #splash .splash-logo{
      width: 250px; height: 250px; object-fit: contain; margin-bottom: 12px;
      filter: drop-shadow(0 4px 10px rgba(0,0,0,.2));
      animation: pop .45s ease both;
    }
    
	#splash .splash-text{
      margin: 0; 
	  font-weight: 600; 
	  font-size: 25px; 
	  color: #006064;
      text-shadow: 
	  -2px -2px 0 #fff;
     2px -2px 0 #fff;
	  -2px  2px 0 #fff;
	   2px  2px 0 #fff;
	  -2px	0	0   #fff;
	   2px	0	0   #fff;
	   0   -2px 0 #fff;
	   0	  2px 0 #fff;
	   
    }	
    @keyframes pop{
      from{ transform: scale(.9); opacity:.6 }
      to  { transform: scale(1);  opacity:1 }
    }
	
	#versionTag {     
	 position: fixed;
	 top: 8px;
	 right: 12px;
	 color: white;
	 font-size: 15px;
	 font-weight: bold;
	 text-shadow: 2px 2px 4px rgba (0,0,0,0.8);
	 z-index: 11000;
	 font-family: 'Kanit',sans-serif;
	}
	
	#clock {
	 position: absolute;
	 top: 3px;
	 left: 50%;
	 transform: translateX(-50%);
	 font-size: 14px;
	 font-weight: 600;
	 color: #fff;
	 z-index: 2000;
    }
	
	header .welcome{
	 position: relative;
	 top: -4px;
	}

	updatesHistoryBtn:active { transform: scale(0.95); }
	
  </style>
</head>
<body>
  <header>
	<div id="clock"></div>
    <img src="welcome.png" alt="Welcome">
    ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (Welcome)
    <img src="logo.png" alt="Logo">
  </header>
	<div id="versionTag">v1.1.5</div> 
    <div class="controls">
    <label for="mapSelect">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà:</label>
    <select id="mapSelect">
      <option value="https://www.google.com/maps/d/embed?mid=1rCujO4jFJ2h2wSa_pnlcmrOaQPZNrhM&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≥‡∏ö‡∏•‡∏î‡∏á‡∏ï‡∏∞‡∏á‡∏≤‡∏ß (Map of Dong Ta Ngao Subdistrict) </option>
      <option value="https://www.google.com/maps/d/embed?mid=1zy3WJ1VOzjpWf1gJQ36VGh1TaB9_7L4&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÇ‡∏ã‡∏•‡πà‡∏≤‡πÄ‡∏ã‡∏•‡∏•‡πå (Solar Power Pole Plan) </option>
      <option value="https://www.google.com/maps/d/embed?mid=1DS8CSBurVMUU-px6qC-HrWu8Wa5CCj0&hl=th&ehbc=2E312F">‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡∏Å‡∏§‡∏ï‡∏ô‡πâ‡∏≥‡∏ó‡πà‡∏ß‡∏° (Flood Crisis Map) </option>
    </select>
	
	<a href="‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Map ABT.pdf" target="_blank"
   style="margin-left:10px; padding:6px 12px; Background:#2196f3; color:#fff;
   text-decoration:none; border-radius:10px; font-weight:50;">
	üìñ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠
	</a>
</div>

<div id="map-area">
    <div class="map-wrap">
      <iframe id="mapFrame"
        src="https://www.google.com/maps/d/embed?mid=1rCujO4jFJ2h2wSa_pnlcmrOaQPZNrhM&hl=th&ehbc=2E312F"
        allowfullscreen></iframe>
      <div class="overlay-top-right" title="‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏á My Maps"></div>
    </div>
 </div>
  
	<div id="clock"></div>

  <!-- FAB ‡∏õ‡∏∏‡πà‡∏° -->
  <button id="installBtn" class="fab" title="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏õ">
    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
      <polyline points="7 10 12 15 17 10"/>
      <line x1="12" y1="3" x2="12" y2="15"/>
    </svg>
  </button>

  <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï (‡∏•‡∏¥‡∏á‡∏Å‡πå PDF) -->
   <a href="updates-history.pdf" target="_blank" 
	id="updatesHistoryBtn"
	style="position:fixed; right:16px; bottom:152px;
      width:56px; height:56px; border:none; border-radius:50%;
      background:#0284c7; color:#fff; display:grid; place-items:center;
      box-shadow:0 8px 18px rgba(0,0,0,.28); z-index:10001; cursor:pointer;
      text-decoration:none;">
  
  <svg viewBox="0 0 24 24" width="26" height="26" fill="none"
       stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
		<rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
		<line x1="16" y1="2" x2="16" y2="6"></line>
		<line x1="8" y1="2" x2="8" y2="6"></line>
		<line x1="3" y1="10" x2="21" y2="10"></line>
  </svg>
</a>

  <button id="refreshBtn" class="fab" title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä">
    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
       <polyline points="23 4 23 10 17 10"/>
       <polyline points="1 20 1 14 7 14"/>
       <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
    </svg>
  </button>

  <button id="updateBtn">üîÑ ‡∏°‡∏µ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà ‚Äì ‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï</button>

  <!-- Splash -->
  <div id="splash" aria-live="polite">
    <img src="logo.png" alt="" class="splash-logo">
    <p class="splash-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶</p>
  </div>
<script>
     const sel = document.getElementById('mapSelect');
     const frame = document.getElementById('mapFrame');
     const saved = localStorage.getItem('abt_selected_map_value');
     if (saved) { sel.value = saved; frame.src = saved; }
      sel.addEventListener('change', () => {
      showSplash('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶');
      frame.src = sel.value;
      localStorage.setItem('abt_selected_map_value', sel.value);
     const t = setTimeout(hideSplash, 2000);
     const onLoaded = () => { clearTimeout(t); hideSplash(); frame.removeEventListener('load', onLoaded); };
      frame.addEventListener('load', onLoaded);
    });

    document.getElementById('refreshBtn').addEventListener('click', () => {
     const btn = document.getElementById('refreshBtn');
      btn.classList.add('spin');
      setTimeout(()=>btn.classList.remove('spin'),1000);
	  showSplash('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‚Ä¶');
      frame.src = frame.src;
     const t = setTimeout(hideSplash, 1500);
     const onLoaded = () => { clearTimeout(t); hideSplash(); frame.removeEventListener('load', onLoaded); };
      frame.addEventListener('load', onLoaded);
    });

    /* PWA Install */
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');
    function isStandalone(){
      return (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches)
             || window.navigator.standalone;
    }
    function updateInstallBtn(){
      installBtn.hidden = isStandalone() || localStorage.getItem('abt_installed')==='1';
    }
    updateInstallBtn();

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      updateInstallBtn();
    });
    
	installBtn.addEventListener('click', async () => {
      installBtn.classList.add('pop');
      setTimeout(()=>installBtn.classList.remove('pop'), 350);
      if (!deferredPrompt) return;
      installBtn.hidden = true;
      deferredPrompt.prompt();
      await deferredPrompt.userChoice;
      deferredPrompt = null;
    });
    window.addEventListener('appinstalled', () => {
      localStorage.setItem('abt_installed','1');
      updateInstallBtn();
    });

    /* SW Update */
    const updateBtn = document.getElementById('updateBtn');
    let newWorker;
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const reg = await navigator.serviceWorker.register('./sw.js');
          reg.update();
          setInterval(() => reg.update(), 15*60*1000);
          reg.addEventListener('updatefound', () => {
            newWorker = reg.installing;
            newWorker?.addEventListener('statechange', () => {
              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                updateBtn.style.display = 'block';
              }
            });
          });
          navigator.serviceWorker.addEventListener('controllerchange', () => location.reload());
        } catch (e) { console.warn('SW register failed', e); }
      });
    }
    updateBtn.addEventListener('click', () => {
      if (newWorker) newWorker.postMessage({ action: 'SKIP_WAITING' });
    });

    /* Splash helpers */
    const splash = document.getElementById('splash');
    function showSplash(msg = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‚Ä¶') {
      const textEl = splash.querySelector('.splash-text');
      if (textEl) textEl.textContent = msg;
      splash.classList.remove('hide');
    }
    function hideSplash() { setTimeout(() => splash.classList.add('hide'), 100); }
     showSplash();
     const firstTimeout = setTimeout(hideSplash, 2000);
     frame.addEventListener('load', () => { clearTimeout(firstTimeout); hideSplash(); }, { once:true });
</script>
	
<script>
    function updateClock() {
     const now = new Date();
     const dateStr = now.toLocaleDateString('th-TH', {
     weekday: 'short',
     day: 'numeric',
     month: 'short',
    });

    // ‡πÄ‡∏û‡∏¥‡πà‡∏° "68" ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
    const date = dateStr + " 68 ‡πÄ‡∏ß‡∏•‡∏≤";

    // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡πá‡∏ô HH:MM:SS
    const hh = String(now.getHours()).padStart(2, '0');
    const mm = String(now.getMinutes()).padStart(2, '0');
    const ss = String(now.getSeconds()).padStart(2, '0');
    const time = `${hh} : ${mm} : ${ss}`;

    document.getElementById('clock').innerHTML = `${date} ${time}&nbsp;‡∏ô.`;
    }
	
    setInterval(updateClock, 1000);
    updateClock();
</script>

	<!-- üÜï ‡πÅ‡∏à‡πâ‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ + ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) -->
<script>
	(function(){
	// ‡πÇ‡∏´‡∏•‡∏î updates.json ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≠‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏≠
		document.addEventListener("DOMContentLoaded", async () => {
		try {
		const res = await fetch("updates.json?ts=" + Date.now(), { cache: "no-store" });
		const data = await res.json();
		const today = new Date().toISOString().split("T")[0];
		const todayUpdate = Array.isArray(data) ? data.find(d => d.date === today) : null;

		if (todayUpdate && todayUpdate.items && todayUpdate.items.length)
		{
	 // ‡∏™‡∏£‡πâ‡∏≤‡∏á modal
        const modal = document.createElement("div");
        modal.id = "dailyUpdateModal";
        modal.style.cssText = `
          position:fixed; inset:0;
          display:flex; align-items:center; justify-content:center;
          background:rgba(0,0,0,0.5);
          z-index:100000; /* ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏∑‡πà‡∏ô ‡πÜ */
        `;
        modal.innerHTML = `
          <div style="
            background:#fff; border-radius:12px;
            width:90%; max-width:420px; padding:20px 24px;
            font-family:'Kanit',sans-serif; box-shadow:0 6px 20px rgba(0,0,0,.3);
            animation:fadeIn .28s ease; position:relative;
          ">
            <h2 style="margin:0 0 12px; color:#2196f3;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâüì¢<br> ‡∏ß‡∏±‡∏ô ‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£ ‡∏ó‡∏µ‡πà 14 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° ‡∏û.‡∏®.2568 <br> **‡∏î‡∏π‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà üìÖ**</h2>
            <ul style="margin:0; padding-left:22px; color:#333; font-size:16px; line-height:1.5;">
              ${todayUpdate.items.map(it => `<li>${it} </li>`).join("")}</ul>
            
			<div style="text-align:center; margin-top:18px;">
              <button id="closeDailyUpdate" style="
                background:#2196f3; color:#fff; border:none; border-radius:8px;
                padding:8px 18px; font-size:16px; cursor:pointer;
              ">‡∏õ‡∏¥‡∏î</button>
            </div>
          </div>
        `;

        // ‡πÉ‡∏™‡πà keyframes ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ô‡∏µ‡πâ (‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏¢‡∏∏‡πà‡∏á CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
        const fx = document.createElement("style");
        fx.textContent = `
          @keyframes fadeIn { from{opacity:0; transform:scale(.92)} to{opacity:1; transform:scale(1)} }
        `;
        document.head.appendChild(fx);

        document.body.appendChild(modal);

        // ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏™‡∏≠‡∏á‡∏ó‡∏≤‡∏á: <audio> ‡πÅ‡∏•‡∏∞ WebAudio ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏ö‡∏£‡∏≤‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ö‡∏•‡πá‡∏≠‡∏Å)
        const playBeep = async () => {
          // ‡∏ß‡∏¥‡∏ò‡∏µ 1: HTMLAudio (base64 ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏±‡πâ‡∏ô‡πÜ)
          try {
            const el = document.createElement('audio');
            el.setAttribute('preload', 'auto');
            el.src =
              'data:audio/mp3;base64,//uQZAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAACAAACcQAAACAAAC4AAAACAAACcQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' +
              'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sQZAADgnAAQAAABAAAACAAACAgACAgICAgICAf//AACAgICA'; // beep ‡πÄ‡∏•‡πá‡∏Å‡πÜ
            await el.play();
            return;
          } catch(e) {
            // ‡∏ß‡∏¥‡∏ò‡∏µ 2: WebAudio tone 0.15s
            try {
              const AudioCtx = window.AudioContext || window.webkitAudioContext;
              const ctx = new AudioCtx();
              const o = ctx.createOscillator();
              const g = ctx.createGain();
              o.type = 'sine';
              o.frequency.value = 880; // A5
              o.connect(g);
              g.connect(ctx.destination);
              g.gain.setValueAtTime(0, ctx.currentTime);
              g.gain.linearRampToValueAtTime(0.15, ctx.currentTime + 0.01);
              g.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.15);
              o.start();
              o.stop(ctx.currentTime + 0.16);
            } catch(_) {
              // ‡πÄ‡∏á‡∏µ‡∏¢‡∏ö ‡πÜ ‡∏ñ‡πâ‡∏≤‡πÇ‡∏î‡∏ô‡∏ö‡∏•‡πá‡∏≠‡∏Å
            }
          }
        };
        playBeep();

        // ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î + ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
        modal.addEventListener('click', (e) => { if (e.target === modal) modal.remove(); });
        modal.querySelector('#closeDailyUpdate').addEventListener('click', () => modal.remove());
      }
    } catch (err) {
      console.warn("‡πÇ‡∏´‡∏•‡∏î updates.json ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:", err);
    }
     });
     })()	 

<script>
	(async function attachUpdatesHistory(){
	try{
    const res = await fetch('updates.json', { cache: 'no-store' });
    const data = await res.json();
    if(!Array.isArray(data) || data.length === 0) return;

    // ‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥)
    const historyBtn = document.getElementById('updatesHistoryBtn');
    const modal      = document.getElementById('updateModal');
    const list       = document.getElementById('updateList');
    const closeBtn   = document.getElementById('closeUpdate');

    // ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÑ‡∏ß‡πâ‡πÉ‡∏ô H3 ‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡∏î‡∏±‡∏•
    const titleEl = modal ? modal.querySelector('h3') : null;

    // 3.1 ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏° üìÖ ‡πÄ‡∏™‡∏°‡∏≠‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô updates.json
    if(historyBtn){ historyBtn.style.display = 'block'; }

    // 3.2 ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î"
    function renderRecent(days = 7){
      if(!modal) return;
      const today = new Date();
      const cutoff = new Date(today.getTime() - (days*24*60*60*1000));

      // ‡∏Ñ‡∏±‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 7 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô
      const recent = data
        .filter(d => !isNaN(new Date(d.date)) && new Date(d.date) >= cutoff)
        .sort((a,b) => b.date.localeCompare(a.date));

      // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î 5 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏ô
      const showList = recent.length ? recent : data.slice().sort((a,b)=>b.date.localeCompare(a.date)).slice(0,5);

      // ‡πÉ‡∏™‡πà‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠
      if(titleEl) titleEl.textContent = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï (‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á)';

      // ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
      list.innerHTML = showList.map(d => `
        <li style="list-style:none; margin:0 0 .5rem 0;">
          <strong>${d.date}</strong>
          <ul style="margin:.25rem 0 0 1.25rem;">
            ${Array.isArray(d.items) ? d.items.map(t => `<li>${t}</li>`).join('') : ''}
          </ul>
        </li>
      `).join('');

      modal.hidden = false;
    }

    // 3.3 ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° üìÖ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á
    if(historyBtn){
      historyBtn.addEventListener('click', () => renderRecent(7));
    }

    // 3.4 ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏° "‡∏õ‡∏¥‡∏î" ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÑ‡∏î‡πâ (‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°)
    if(closeBtn){
      closeBtn.addEventListener('click', () => { modal.hidden = true; });
    }
    if(modal){
      modal.addEventListener('click', (e) => {
        if(e.target === modal) modal.hidden = true;
      });
    }
  }catch(e){
    console.warn('‡πÇ‡∏´‡∏•‡∏î updates.json ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', e);
  }
})();
</script>

<script>
	// ===== ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï (üìÖ) =====
(() => {
	const btn = document.getElementById('updatesHistoryBtn');
	if (!btn) return; 

	const modal = document.getElementById('updateModal');
	const list  = document.getElementById('updateList');
	const close = document.getElementById('closeUpdate');

  // ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° üìÖ
  btn.addEventListener('click', async () => {
    try {
      const res = await fetch('updates.json', { cache: 'no-store' });
      const data = await res.json();

      // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà ‚Üí ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î
      data.sort((a,b) => b.date.localeCompare(a.date));

      // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ 7 ‡∏ß‡∏±‡∏ô/7 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏õ‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÑ‡∏î‡πâ)
      const recent = data.slice(0, 7);
      list.innerHTML = recent.map(d => `
        <li>
          <strong>${d.date}</strong>
          <ul style="margin:.25rem 0 .75rem 1rem;">
            ${ (d.items||[]).map(t => `<li>${t}</li>`).join('') }
          </ul>
        </li>
      `).join('');

      modal.hidden = false;   // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á
    } catch(e) {
      list.innerHTML = `<li>‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå updates.json ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</li>`;
      modal.hidden = false;
      console.warn(e);
    }
  });

  // ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πà‡∏≠‡∏á (‡∏õ‡∏∏‡πà‡∏°/‡∏Ñ‡∏•‡∏¥‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á/‡∏õ‡∏∏‡πà‡∏° ESC)
	close?.addEventListener('click', () => modal.hidden = true);
	modal?.addEventListener('click', e => { if (e.target === modal) modal.hidden = true; });
	document.addEventListener('keydown', e => { if (e.key === 'Escape') modal.hidden = true; });
	})();
</script>
</script>
</body>
</html>